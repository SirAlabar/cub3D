=== BSP TEST SUITE ===

[TEST 1] Map Line Extraction: 
=== Map Details ===
Vertices (8):
v0: (165, 21)
v1: (293, 21)
v2: (293, 149)
v3: (165, 149)
v4: (67, 187)
v5: (195, 187)
v6: (195, 315)
v7: (67, 315)

Linedefs (10):
l0: v0 -> v1 (type: 0, front_sidedef: 0, back_sidedef: -1)
l1: v1 -> v2 (type: 0, front_sidedef: 0, back_sidedef: -1)
l2: v2 -> v3 (type: 0, front_sidedef: 0, back_sidedef: -1)
l3: v3 -> v0 (type: 0, front_sidedef: 0, back_sidedef: -1)
l4: v4 -> v5 (type: 0, front_sidedef: 0, back_sidedef: -1)
l5: v5 -> v6 (type: 0, front_sidedef: 0, back_sidedef: -1)
l6: v6 -> v7 (type: 0, front_sidedef: 0, back_sidedef: -1)
l7: v7 -> v4 (type: 0, front_sidedef: 0, back_sidedef: -1)
l8: v7 -> v0 (type: 0, front_sidedef: 0, back_sidedef: -1)
l9: v0 -> v6 (type: 0, front_sidedef: 0, back_sidedef: -1)

=== End of Map Details ===



=== Testing Map Line Extraction ===

=== Detailed Map Line Extraction ===
Total vertices: 8
Total linedefs: 10

Processing Linedef 0:
  Vertex1 index: 0
  Vertex2 index: 1
  Start: (165, 21)
  End: (293, 21)

Processing Linedef 1:
  Vertex1 index: 1
  Vertex2 index: 2
  Start: (293, 21)
  End: (293, 149)

Processing Linedef 2:
  Vertex1 index: 2
  Vertex2 index: 3
  Start: (293, 149)
  End: (165, 149)

Processing Linedef 3:
  Vertex1 index: 3
  Vertex2 index: 0
  Start: (165, 149)
  End: (165, 21)

Processing Linedef 4:
  Vertex1 index: 4
  Vertex2 index: 5
  Start: (67, 187)
  End: (195, 187)

Processing Linedef 5:
  Vertex1 index: 5
  Vertex2 index: 6
  Start: (195, 187)
  End: (195, 315)

Processing Linedef 6:
  Vertex1 index: 6
  Vertex2 index: 7
  Start: (195, 315)
  End: (67, 315)

Processing Linedef 7:
  Vertex1 index: 7
  Vertex2 index: 4
  Start: (67, 315)
  End: (67, 187)

Processing Linedef 8:
  Vertex1 index: 7
  Vertex2 index: 0
  Start: (67, 315)
  End: (165, 21)

Processing Linedef 9:
  Vertex1 index: 0
  Vertex2 index: 6
  Start: (165, 21)
  End: (195, 315)
Successfully extracted 10 lines
Line 0: (165,21) -> (293,21) [type: 0]
Line 1: (293,21) -> (293,149) [type: 0]
Line 2: (293,149) -> (165,149) [type: 0]
Line 3: (165,149) -> (165,21) [type: 0]
Line 4: (67,187) -> (195,187) [type: 0]
PASS

[TEST 2] Line Classification: 
=== Testing Line Classification ===

=== Detailed Map Line Extraction ===
Total vertices: 12
Total linedefs: 16

Processing Linedef 0:
  Vertex1 index: 0
  Vertex2 index: 1
  Start: (7, 2)
  End: (135, 2)

Processing Linedef 1:
  Vertex1 index: 1
  Vertex2 index: 2
  Start: (135, 2)
  End: (135, 130)

Processing Linedef 2:
  Vertex1 index: 2
  Vertex2 index: 3
  Start: (135, 130)
  End: (7, 130)

Processing Linedef 3:
  Vertex1 index: 3
  Vertex2 index: 0
  Start: (7, 130)
  End: (7, 2)

Processing Linedef 4:
  Vertex1 index: 4
  Vertex2 index: 5
  Start: (96, 233)
  End: (224, 233)

Processing Linedef 5:
  Vertex1 index: 5
  Vertex2 index: 6
  Start: (224, 233)
  End: (224, 361)

Processing Linedef 6:
  Vertex1 index: 6
  Vertex2 index: 7
  Start: (224, 361)
  End: (96, 361)

Processing Linedef 7:
  Vertex1 index: 7
  Vertex2 index: 4
  Start: (96, 361)
  End: (96, 233)

Processing Linedef 8:
  Vertex1 index: 8
  Vertex2 index: 9
  Start: (74, 98)
  End: (202, 98)

Processing Linedef 9:
  Vertex1 index: 9
  Vertex2 index: 10
  Start: (202, 98)
  End: (202, 226)

Processing Linedef 10:
  Vertex1 index: 10
  Vertex2 index: 11
  Start: (202, 226)
  End: (74, 226)

Processing Linedef 11:
  Vertex1 index: 11
  Vertex2 index: 8
  Start: (74, 226)
  End: (74, 98)

Processing Linedef 12:
  Vertex1 index: 6
  Vertex2 index: 11
  Start: (224, 361)
  End: (74, 226)

Processing Linedef 13:
  Vertex1 index: 7
  Vertex2 index: 0
  Start: (96, 361)
  End: (7, 2)

Processing Linedef 14:
  Vertex1 index: 7
  Vertex2 index: 11
  Start: (96, 361)
  End: (74, 226)

Processing Linedef 15:
  Vertex1 index: 3
  Vertex2 index: 7
  Start: (7, 130)
  End: (96, 361)
Partition Line: (7,2) -> (135,2)
Line 1: (135,2) -> (135,130) - Side: 1
Line 2: (135,130) -> (7,130) - Side: 1
Line 3: (7,130) -> (7,2) - Side: 1
Line 4: (96,233) -> (224,233) - Side: 1
Line 5: (224,233) -> (224,361) - Side: 1
Line 6: (224,361) -> (96,361) - Side: 1
Line 7: (96,361) -> (96,233) - Side: 1
Line 8: (74,98) -> (202,98) - Side: 1
Line 9: (202,98) -> (202,226) - Side: 1
Line 10: (202,226) -> (74,226) - Side: 1
Line 11: (74,226) -> (74,98) - Side: 1
Line 12: (224,361) -> (74,226) - Side: 1
Line 13: (96,361) -> (7,2) - Side: 1
Line 14: (96,361) -> (74,226) - Side: 1
Line 15: (7,130) -> (96,361) - Side: 1
PASS

[TEST 3] Partition Selection: 
=== Testing Partition Selection ===

=== Detailed Map Line Extraction ===
Total vertices: 12
Total linedefs: 16

Processing Linedef 0:
  Vertex1 index: 0
  Vertex2 index: 1
  Start: (7, 2)
  End: (135, 2)

Processing Linedef 1:
  Vertex1 index: 1
  Vertex2 index: 2
  Start: (135, 2)
  End: (135, 130)

Processing Linedef 2:
  Vertex1 index: 2
  Vertex2 index: 3
  Start: (135, 130)
  End: (7, 130)

Processing Linedef 3:
  Vertex1 index: 3
  Vertex2 index: 0
  Start: (7, 130)
  End: (7, 2)

Processing Linedef 4:
  Vertex1 index: 4
  Vertex2 index: 5
  Start: (96, 233)
  End: (224, 233)

Processing Linedef 5:
  Vertex1 index: 5
  Vertex2 index: 6
  Start: (224, 233)
  End: (224, 361)

Processing Linedef 6:
  Vertex1 index: 6
  Vertex2 index: 7
  Start: (224, 361)
  End: (96, 361)

Processing Linedef 7:
  Vertex1 index: 7
  Vertex2 index: 4
  Start: (96, 361)
  End: (96, 233)

Processing Linedef 8:
  Vertex1 index: 8
  Vertex2 index: 9
  Start: (74, 98)
  End: (202, 98)

Processing Linedef 9:
  Vertex1 index: 9
  Vertex2 index: 10
  Start: (202, 98)
  End: (202, 226)

Processing Linedef 10:
  Vertex1 index: 10
  Vertex2 index: 11
  Start: (202, 226)
  End: (74, 226)

Processing Linedef 11:
  Vertex1 index: 11
  Vertex2 index: 8
  Start: (74, 226)
  End: (74, 98)

Processing Linedef 12:
  Vertex1 index: 6
  Vertex2 index: 11
  Start: (224, 361)
  End: (74, 226)

Processing Linedef 13:
  Vertex1 index: 7
  Vertex2 index: 0
  Start: (96, 361)
  End: (7, 2)

Processing Linedef 14:
  Vertex1 index: 7
  Vertex2 index: 11
  Start: (96, 361)
  End: (74, 226)

Processing Linedef 15:
  Vertex1 index: 3
  Vertex2 index: 7
  Start: (7, 130)
  End: (96, 361)
Best Partition Selected: (202,226) -> (74,226)
PASS

[TEST 4] Point Classification: 
=== Testing Point Classification ===
Test Line: (0,0) -> (100,0)

Testing clear front/back points:
Point Front (50,10): 1
Point Back (50,-10): -1

Testing point on the line:
Point Near (50,0): 2

Testing point beyond endpoint:
Point Beyond (150,0): 2

Testing with diagonal line:
Diagonal Line: (0,0) -> (100,100)
Test Point (50,40): -1

=== End of Point Classification Tests ===
PASS

[TEST 5] Line Splitting: 
=== Testing Line Splitting ===

Test 1 - Basic Perpendicular Split:
Partition: (0,100) -> (200,100)
Line: (100,0) -> (100,200)
Split successful!
Front part: (100,100) -> (100,200)
Back part: (100,0) -> (100,100)

Test 2 - 45-Degree Diagonal Split:
Partition: (0,0) -> (100,100)
Line: (0,100) -> (100,0)
Split successful!
Front part: (0,100) -> (50,50)
Back part: (50,50) -> (100,0)

Test 3 - Parallel Lines:
Testing parallel line with horizontal partition:
Line: (0,150) -> (200,150)
No split (correct for parallel lines)

Test 4 - Steep Angle Split:
Partition: (0,0) -> (10,100)
Line: (0,100) -> (10,0)
Split successful!
Front part: (0,100) -> (5,50)
Back part: (5,50) -> (10,0)

Test 5 - Edge Case Split:
Partition: (100,0) -> (100,100)
Line: (99,50) -> (101,50)
Split successful!
Front part: (99,50) -> (100,50)
Back part: (100,50) -> (101,50)

=== End of Line Splitting Tests ===
PASS

[TEST 6] BSP Tree Construction: 
=== Comprehensive BSP Tree Construction Test ===

=== Detailed Map Line Extraction ===
Total vertices: 12
Total linedefs: 16

Processing Linedef 0:
  Vertex1 index: 0
  Vertex2 index: 1
  Start: (7, 2)
  End: (135, 2)

Processing Linedef 1:
  Vertex1 index: 1
  Vertex2 index: 2
  Start: (135, 2)
  End: (135, 130)

Processing Linedef 2:
  Vertex1 index: 2
  Vertex2 index: 3
  Start: (135, 130)
  End: (7, 130)

Processing Linedef 3:
  Vertex1 index: 3
  Vertex2 index: 0
  Start: (7, 130)
  End: (7, 2)

Processing Linedef 4:
  Vertex1 index: 4
  Vertex2 index: 5
  Start: (96, 233)
  End: (224, 233)

Processing Linedef 5:
  Vertex1 index: 5
  Vertex2 index: 6
  Start: (224, 233)
  End: (224, 361)

Processing Linedef 6:
  Vertex1 index: 6
  Vertex2 index: 7
  Start: (224, 361)
  End: (96, 361)

Processing Linedef 7:
  Vertex1 index: 7
  Vertex2 index: 4
  Start: (96, 361)
  End: (96, 233)

Processing Linedef 8:
  Vertex1 index: 8
  Vertex2 index: 9
  Start: (74, 98)
  End: (202, 98)

Processing Linedef 9:
  Vertex1 index: 9
  Vertex2 index: 10
  Start: (202, 98)
  End: (202, 226)

Processing Linedef 10:
  Vertex1 index: 10
  Vertex2 index: 11
  Start: (202, 226)
  End: (74, 226)

Processing Linedef 11:
  Vertex1 index: 11
  Vertex2 index: 8
  Start: (74, 226)
  End: (74, 98)

Processing Linedef 12:
  Vertex1 index: 6
  Vertex2 index: 11
  Start: (224, 361)
  End: (74, 226)

Processing Linedef 13:
  Vertex1 index: 7
  Vertex2 index: 0
  Start: (96, 361)
  End: (7, 2)

Processing Linedef 14:
  Vertex1 index: 7
  Vertex2 index: 11
  Start: (96, 361)
  End: (74, 226)

Processing Linedef 15:
  Vertex1 index: 3
  Vertex2 index: 7
  Start: (7, 130)
  End: (96, 361)
Map Details:
Total vertices: 12
Total linedefs: 16
Lines extracted: 16

=== Detailed Map Line Extraction ===
Total vertices: 12
Total linedefs: 16

Processing Linedef 0:
  Vertex1 index: 0
  Vertex2 index: 1
  Start: (7, 2)
  End: (135, 2)

Processing Linedef 1:
  Vertex1 index: 1
  Vertex2 index: 2
  Start: (135, 2)
  End: (135, 130)

Processing Linedef 2:
  Vertex1 index: 2
  Vertex2 index: 3
  Start: (135, 130)
  End: (7, 130)

Processing Linedef 3:
  Vertex1 index: 3
  Vertex2 index: 0
  Start: (7, 130)
  End: (7, 2)

Processing Linedef 4:
  Vertex1 index: 4
  Vertex2 index: 5
  Start: (96, 233)
  End: (224, 233)

Processing Linedef 5:
  Vertex1 index: 5
  Vertex2 index: 6
  Start: (224, 233)
  End: (224, 361)

Processing Linedef 6:
  Vertex1 index: 6
  Vertex2 index: 7
  Start: (224, 361)
  End: (96, 361)

Processing Linedef 7:
  Vertex1 index: 7
  Vertex2 index: 4
  Start: (96, 361)
  End: (96, 233)

Processing Linedef 8:
  Vertex1 index: 8
  Vertex2 index: 9
  Start: (74, 98)
  End: (202, 98)

Processing Linedef 9:
  Vertex1 index: 9
  Vertex2 index: 10
  Start: (202, 98)
  End: (202, 226)

Processing Linedef 10:
  Vertex1 index: 10
  Vertex2 index: 11
  Start: (202, 226)
  End: (74, 226)

Processing Linedef 11:
  Vertex1 index: 11
  Vertex2 index: 8
  Start: (74, 226)
  End: (74, 98)

Processing Linedef 12:
  Vertex1 index: 6
  Vertex2 index: 11
  Start: (224, 361)
  End: (74, 226)

Processing Linedef 13:
  Vertex1 index: 7
  Vertex2 index: 0
  Start: (96, 361)
  End: (7, 2)

Processing Linedef 14:
  Vertex1 index: 7
  Vertex2 index: 11
  Start: (96, 361)
  End: (74, 226)

Processing Linedef 15:
  Vertex1 index: 3
  Vertex2 index: 7
  Start: (7, 130)
  End: (96, 361)

BSP Tree Analysis:
Total nodes: 20
Maximum tree depth: 5
Error: Invalid partition geometry
Error: Invalid partition geometry
BSP Tree Stats:
- Max Depth: 5
- Total Errors: 2
FAIL: BSP tree validation failed

BSP Tree Structure:

=== BSP Tree ===


Partition: Line: (202,226) -> (74,226) [type: 0]
Lines (0):
├── Front:
│
  Partition: Line: (96,361) -> (7,2) [type: 0]
  Lines (0):
│├── Front:
││
    Partition: Line: (135,2) -> (135,130) [type: 0]
    Lines (0):
││├── Front:
│││
      Partition: Line: (74,98) -> (135,98) [type: 0]
      Lines (0):
│││├── Front:
││││
        Partition: Line: (74,226) -> (74,98) [type: 0]
        Lines (0):
││││├── Front:
│││││
          Partition: Line: (135,130) -> (74,130) [type: 0]
          Lines (0):
││││└── Back:
││││   
          Partition: Line: (74,130) -> (7,130) [type: 0]
          Lines (0):
│││└── Back:
│││   
        Partition: Line: (7,2) -> (135,2) [type: 0]
        Lines (0):
││└── Back:
││   
      Partition: Line: (202,98) -> (202,226) [type: 0]
      Lines (0):
││   ├── Front:
││   │
        Partition: Line: (135,98) -> (202,98) [type: 0]
        Lines (0):
│└── Back:
│   
    Partition: Line: (7,130) -> (7,130) [type: 0]
    Lines (0):
│   ├── Front:
│   │
      Partition: Line: (7,130) -> (96,361) [type: 0]
      Lines (0):
│   │└── Back:
│   │   
        Partition: Line: (7,130) -> (7,2) [type: 0]
        Lines (0):
└── Back:
   
  Partition: Line: (224,361) -> (74,226) [type: 0]
  Lines (0):
   ├── Front:
   │
    Partition: Line: (224,233) -> (224,361) [type: 0]
    Lines (0):
   │├── Front:
   ││
      Partition: Line: (96,233) -> (224,233) [type: 0]
      Lines (0):
   ││├── Front:
   │││
        Partition: Line: (96,361) -> (96,233) [type: 0]
        Lines (0):
   └── Back:
      
    Partition: Line: (96,361) -> (96,361) [type: 0]
    Lines (0):
      ├── Front:
      │
      Partition: Line: (96,361) -> (74,226) [type: 0]
      Lines (0):
      │├── Front:
      ││
        Partition: Line: (224,361) -> (96,361) [type: 0]
        Lines (0):

=== End of Tree ===

Traversal Tests:

Testing point 1: (7,67)
Traversal path:
Level 0: (202,226) -> (74,226) - Point is FRONT
Level 1: (96,361) -> (7,2) - Point is BACK
Level 2: (7,130) -> (7,130) - Point is ON LINE
Level 3: (7,130) -> (96,361) - Point is BACK
Level 4: (7,130) -> (7,2) - Point is ON LINE
Found terminal node at depth 4

Testing point 2: (139,98)
Traversal path:
Level 0: (202,226) -> (74,226) - Point is FRONT
Level 1: (96,361) -> (7,2) - Point is FRONT
Level 2: (135,2) -> (135,130) - Point is BACK
Level 3: (202,98) -> (202,226) - Point is FRONT
Level 4: (135,98) -> (202,98) - Point is ON LINE
Found terminal node at depth 4

Testing point 3: (149,292)
Traversal path:
Level 0: (202,226) -> (74,226) - Point is BACK
Level 1: (224,361) -> (74,226) - Point is FRONT
Level 2: (224,233) -> (224,361) - Point is FRONT
Level 3: (96,233) -> (224,233) - Point is FRONT
Level 4: (96,361) -> (96,233) - Point is FRONT
Found terminal node at depth 4
=== End of BSP Tree Construction Test ===
PASS

=== TEST SUMMARY ===
Passed: 6/6
Success Rate: %
